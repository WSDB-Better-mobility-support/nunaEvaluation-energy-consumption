clear;
close all;
clc;
%% Data
lp1 = [
    0 3890 1.0088206950958953 3.924312503923033
    1 1455 1.0610270532543933 1.543794362485142
    2 4230 0.9698472734566006 4.10245396672142
    3 4555 0.9593282311429704 4.36974009285623
    4 780 1.102880350420086 0.8602466733276669
    5 4980 0.9903874528578828 4.932129515232257
    6 2750 0.9253172565845867 2.5446224556076134
    7 3150 0.9052400569072491 2.8515061792578345
    ];
lp2=[
    0 1465 1.203853157400052 1.7636448755910763
    1 3280 0.9295719695243234 3.048996060039781
    2 775 1.192478732884209 0.924171017985262
    3 3515 0.934095729364672 3.283346488716822
    4 3335 0.9417114510780749 3.1406076893453796
    ];
lp3=[
    0 2970 0.9738629909578043 2.892373083144679
    1 1185 1.0474943673348402 1.2412808252917857
    2 3600 0.9462060334745899 3.4063417205085234
    3 525 1.0279028039005098 0.5396489720477676
    4 2025 1.0507712724861207 2.127811826784394
    5 2866 0.9504430584074427 2.723969805395731
    ];
lp4=[
    0 3335 0.9531715297444827 3.17882705169785
    1 630 1.0689522856595903 0.6734399399655419
    2 2740 0.9503707152952611 2.6040157599090152
    3 4650 0.9913469958218916 4.609763530571795
    4 6010 0.9634252795757868 5.7901859302504795
    5 780 1.0717231470559867 0.8359440547036696
    6 3875 0.9289526906656138 3.5996916763292535
    7 630 1.0882936796813782 0.6856250181992684
    8 895 1.1098948901584715 0.993355926691832
    9 3140 0.943312009616095 2.9619997101945383
    ];
lp5=[
    0 3125 0.9802001822888095 3.0631255696525295
    1 635 1.1134742235252513 0.7070561319385346
    2 6015 0.9487583236685666 5.706781316866428
    3 1595 1.2415171779153304 1.980219898774952
    4 1125 1.121762854335895 1.261983211127882
    5 3295 0.9727828011596518 3.2053193298210525
    6 4616 0.8623659710846663 3.9806813225268196
    7 640 1.0521150780712034 0.6733536499655702
    8 6110 0.7996139805304215 4.885641421040876
    9 1675 1.2402666204476973 2.077446589249893
    10 475 1.0164501728059547 0.4828138320828285
    11 4430 0.9667360286505032 4.2826406069217295
    ];
cp1 = [
    0 1905 1.2673512435403365 2.414304118944341
    1 4035 0.9880790501090011 3.9868989671898194
    2 3480 0.9875656676000227 3.436728523248079
    3 1815 1.0873924099959567 1.9736172241426613
    4 3986 1.0228100681858379 4.07692093178875
    5 3050 1.07761051319525 3.2867120652455126
    6 3255 1.0627029216787174 3.459098010064225
    7 2025 1.1264750689870635 2.2811120146988038
    8 1235 1.2022951711521523 1.484834536372908
    9 4346 0.9507467395497888 4.131945330083382
    10 3445 1.0394579657635208 3.580932692055329
    11 1470 1.0874018748519434 1.5984807560323568
    12 4095 0.9729929758033348 3.984406235914656
    13 1635 1.0978039111162938 1.7949093946751404
    14 4449 0.9307395688552779 4.140860341837131
    15 1765 1.1209520810416174 1.9784804230384545
    16 3406 0.942624424209981 3.2105787888591952
    17 1390 1.0485240359441248 1.4574484099623335
    18 1545 1.0329791827525618 1.595952837352708
    19 4530 0.927696119580408 4.202463421699248
    20 2855 0.9734124653331148 2.7790925885260425
    21 1390 1.1330011588097206 1.5748716107455116
    22 4275 1.0448006424224106 4.466522746355805
    23 2348 1.0440452951908636 2.451418353108148
    24 4415 0.9942151084579501 4.389459703841849
    25 1420 1.0768854289748218 1.5291773091442469
    26 4205 0.9510983689829403 3.999368641573264
    27 1420 1.0755344380376564 1.527258902013472
    28 2295 1.0471802799051941 2.4032787423824207
    29 3356 0.9443071649523301 3.16909484558002
    30 2340 1.1286354748964091 2.641007011257597
    ];
cp2 = [
    0 3450 1.0273196635484572 3.5442528392421773
    1 1870 1.096015320007397 2.049548648413832
    2 3620 0.989648080346611 3.5825260508547316
    3 1690 1.1530109862925768 1.948588566834455
    4 6440 0.9266282728660121 5.967486077257118
    5 1385 1.1688335949384756 1.6188345289897887
    6 2395 1.094879024169292 2.6222352628854546
    7 3070 0.9807579698646902 3.010926967484599
    8 1855 1.0960888903563784 2.0332448916110817
    9 1320 1.1443031555809065 1.5104801653667967
    10 1290 1.109549385216667 1.4313187069295004
    11 415 1.1146495005951829 0.4625795427470009
    12 4174 0.9883513203553793 4.125378411163353
    13 1615 1.0381343167115356 1.67658692148913
    14 2897 1.0013821870612232 2.9010041959163635
    15 1795 1.0417499489987467 1.86994115845275
    16 3043 0.9698131937291891 2.9511415485179224
    17 1725 1.3245504940874173 2.2848496023007945
    18 3126 0.9390474895438737 2.935462452314149
    19 1540 1.1194429177891676 1.7239420933953182
    20 3755 0.9791807974125495 3.6768238942841234
    21 1765 1.0750861901005313 1.897527125527438
    22 1610 1.0251873554164759 1.650551642220526
    23 2062 1.0999500729928517 2.2680970505112605
    24 1490 1.009256061530364 1.5037915316802424
    25 1320 1.016886822056689 1.3422906051148293
    26 5070 0.6140766640310743 3.1133686866375463
    ];
cp3 = [
    0 3505 0.993073408825086 3.4807222979319263
    1 1885 1.1180702631557127 2.1075624460485183
    2 4299 1.001056412868601 4.303541518922116
    3 2285 1.0622960295525248 2.427346427527519
    4 4110 0.9685400497295059 3.980699604388269
    5 1341 1.148746765090313 1.5404694119861098
    6 5790 0.976689266412359 5.655030852527559
    7 3190 1.05268009188577 3.358049493115606
    8 3209 0.9887095597861242 3.1727689773536727
    9 1970 1.0184566774689547 2.0063596546138407
    10 2065 1.083788952011477 2.2380241859037002
    11 5965 0.9583153603019833 5.7163511242013305
    12 1410 1.1516225551860257 1.6237878028122963
    13 860 1.0810669859858308 0.9297176079478146
    14 2135 1.278874256131602 2.73039653684097
    15 2520 1.0664794422175565 2.6875281943882423
    16 3580 0.9663378585987054 3.459489533783365
    17 2895 1.0902349003755034 3.1562300365870826
    18 1580 1.012286823844384 1.5994131816741266
    19 1825 1.1547555389815312 2.1074288586412946
    20 4215 1.034624016967635 4.3609402315185815
    21 1200 1.1942802005170439 1.4331362406204526
    22 4730 1.0096521782936614 4.775654803329018
    23 1135 1.0990961239114507 1.2474741006394965
    24 2745 1.0953065254485579 3.0066164123562915
    25 1305 1.129850572235049 1.4744549967667389
    26 2158 1.0628141265271422 2.293552885045573
    27 2430 1.0733492391010866 2.60823865101564
    ];
cp4=[
    0 4515 1.023685212122565 4.621938732733382
    1 1850 1.100450454179167 2.0358333402314592
    2 2215 1.0039994168940105 2.223858708420233
    3 4425 1.0112488036838656 4.474775956301105
    4 2040 1.0895712275667706 2.2227253042362123
    5 1400 1.1236324333364984 1.5730854066710978
    6 3300 0.9719586399951917 3.2074635119841326
    7 2410 1.0802129362755917 2.6033131764241757
    8 1750 1.1616488071821571 2.032885412568775
    9 5670 0.9258287205499578 5.249448845518261
    10 2420 1.0286835545949533 2.489414202119787
    11 6400 0.8892785814429751 5.691382921235041
    12 1484 1.0688821683343899 1.5862211378082345
    13 4795 0.9603264029794246 4.604765102286341
    14 1800 1.063412203540891 1.914141966373604
    15 4315 0.9143513654790879 3.9454261420422645
    16 4140 0.9887198522190742 4.0933001881869675
    17 1365 1.0915155591537198 1.4899187382448276
    18 3910 0.9409281841390006 3.6790291999834923
    19 2260 1.1087124407496534 2.5056901160942164
    20 3114 0.9517750716717241 2.963827573185749
    21 1935 1.0578209073330713 2.046883455689493
    22 1420 1.1052165599254575 1.5694075150941496
    23 2685 1.0756010408184977 2.8879887945976668
    24 3800 1.0275297943146644 3.904613218395725
    25 1515 1.1703255035441475 1.7730431378693836
    26 6835 0.8152818881959859 5.572451705819564
    27 880 1.1332174595615867 0.9972313644141964
    28 3830 1.000689804778273 3.832641952300786
    29 1240 1.1156801148072095 1.3834433423609398
    30 2480 1.0192490305510928 2.52773759576671
    31 8845 0.9664332922742322 8.548102470165585
    ];
cp5 = [
    0 1175 1.1585207146052454 1.3612618396611633
    1 6190 0.9337012239692091 5.779610576369404
    2 3160 0.9943291856048125 3.1420802265112076
    3 1581 1.1526020119800757 1.8222637809404996
    4 3720 1.0255785512677111 3.815152210715886
    5 2541 1.181159673717811 3.001326730916958
    6 3973 1.0694940164542956 4.249099727372916
    7 1965 1.1601334284096092 2.2796621868248823
    8 3205 0.9910432646631028 3.1762936632452443
    9 2555 1.116231510660614 2.851971509737869
    10 4645 1.0149305166127123 4.714352249666048
    11 3420 0.9879040526309498 3.3786318599978484
    12 1565 1.1349492760402131 1.7761956170029334
    13 4120 0.9338881037187583 3.8476189873212845
    14 1660 1.0833587958077147 1.7983756010408065
    15 1635 1.071019279606814 1.7511165221571412
    16 4525 1.0708639654876912 4.845659443831803
    17 1655 1.1433451231886498 1.8922361788772153
    18 1855 1.0809015461924498 2.0050723681869944
    19 1025 1.0945546917051387 1.1219185589977672
    20 1820 1.1225181791206842 2.042983085999645
    21 3415 1.059875343476308 3.6194742979715917
    22 1130 1.3068010299939283 1.4766851638931389
    23 3575 1.0035937295759905 3.587847583234166
    24 1135 1.0865904029864948 1.2332801073896718
    25 3605 1.0437389526390224 3.7626789242636756
    26 1160 1.082813740501496 1.2560639389817352
    27 3590 0.9500396251150242 3.4106422541629366
    28 3010 0.974735962492816 2.933955247103376
    29 2165 1.093614767294411 2.3676759711923996
    ];

sp1 = [
    0 775 1.8018436631651316 1.396428838952977
    1 1850 1.224445430729376 2.2652240468493456
    2 1025 1.2278294224960689 1.2585251580584706
    3 5771 1.3695883027226847 7.903894095012613
    4 2055 1.2147614138311862 2.4963347054230876
    5 1600 1.2701030289919455 2.0321648463871127
    6 1125 1.0282580802493366 1.1567903402805035
    7 1135 1.062417365506856 1.2058437098502817
    8 3055 1.1592409373742558 3.5414810636783516
    9 1125 1.2294871549484505 1.383173049317007
    10 3135 1.206448176997359 3.7822150348867205
    11 1200 1.1975328178207374 1.4370393813848847
    12 2750 1.203477185737135 3.309562260777121
    13 1300 1.1833354577113098 1.5383360950247027
    14 1230 1.1773170612920978 1.4480999853892802
    15 3108 1.1631227830552546 3.6149856097357316
    16 1220 1.1954002013330225 1.4583882456262875
    17 3073 1.1273116292418885 3.4642286366603234
    18 1495 1.1085560012185396 1.6572912218217166
    19 3855 1.3203728473871 5.090037326677271
    20 1295 1.1450351761808375 1.4828205531541847
    21 910 1.2952921184466093 1.1787158277864143
    22 6290 0.968560660000316 6.0922465514019875
    23 1255 1.3000078275287523 1.631509823548584
    24 3750 1.1744346189906254 4.404129821214845
    25 930 1.2366702410908599 1.1501033242144998
    26 1150 1.2400769869297403 1.4260885349692014
    27 3525 1.1887156519694702 4.190222673192382
    28 995 1.190613676353487 1.1846606079717195
    29 1040 1.1520868276543605 1.1981703007605349
    ];

sp2=[
    30 6440 0.9692541892280839 6.24199697862886
    31 1385 1.1988340081091844 1.6603851012312203
    32 1520 1.1403480623972873 1.7333290548438767
    33 1004 1.1550857124206513 1.159706055270334
    34 2945 1.3390719466642855 3.943566882926321
    35 1170 1.1604078106656066 1.3576771384787596
    36 5715 1.0136825593989311 5.793195826964891
    37 1085 1.1396275812909515 1.2364959257006825
    38 1655 1.2455176300634763 2.061331677755053
    39 4185 1.1276741236241137 4.719316207366916
    40 995 1.1199401432678728 1.1143404425515335
    41 2740 1.1190948710467983 3.0663199466682274
    42 1040 1.1167477375367918 1.1614176470382636
    43 3580 1.1286569627650163 4.040591926698758
    44 1010 1.2018695674119222 1.2138882630860415
    45 6060 1.0403060518157403 6.304254674003386
    46 1360 1.2142301966092452 1.6513530673885737
    47 5645 0.9273269057853939 5.234760383158548
    48 1060 1.1381043551823868 1.20639061649333
    49 2885 1.2032566588330418 3.471395460733326
    50 1010 1.104547401760669 1.1155928757782756
    51 3650 1.1260298883637274 4.110009092527606
    52 1445 1.1380672076055498 1.6445071149900194
    53 1400 1.181416685199475 1.653983359279265
    54 3385 1.219546152091698 4.128163724830398
    55 1020 1.1808773141168298 1.2044948603991663
    56 3042 1.2077614936171077 3.6740104635832416
    57 1225 1.1528975320049002 1.4122994767060026
    58 2925 1.1923835359574892 3.4877218426756564
    59 1650 1.148222247248501 1.8945667079600266
    ];

sp3=[
    60 1040 1.2142024791616688 1.2627705783281356
    61 3935 1.1866039389499194 4.669286499767932
    62 1620 1.2181414500669328 1.973389149108431
    63 1780 1.171203909202375 2.084742958380227
    64 1070 1.155741325769953 1.2366432185738496
    65 1028 1.158221770552227 1.1906519801276896
    66 3300 1.1875747572691557 3.918996698988214
    67 1715 1.1729398175118082 2.011591787032751
    68 1020 1.15742413020385 1.180572612807927
    69 1060 1.1357021585002198 1.203844288010233
    70 3948 1.152848216341467 4.551444758116112
    71 1085 1.1294960304319244 1.2255031930186377
    72 2965 1.4142649247116899 4.1932955017701605
    73 1095 1.1330796511307932 1.2407222179882185
    74 5220 1.2099545911013692 6.315962965549147
    75 1028 1.1762200999747807 1.2091542627740746
    76 3170 1.2862175885992337 4.077309755859571
    77 1120 1.1495386328159714 1.2874832687538877
    78 1025 1.187945640279086 1.2176442812860633
    79 950 1.159371963241877 1.1014033650797832
    80 3585 1.209584543880874 4.336360589812934
    81 1036 1.2891946429550507 1.3356056501014324
    82 2915 1.308788310168134 3.8151179241401105
    83 1040 1.1963511273292742 1.2442051724224452
    84 2970 1.2568633719959768 3.7328842148280508
    85 1095 1.161822629789899 1.2721957796199395
    86 3085 1.2958078505226087 3.997567218862248
    87 1070 1.1407843828488107 1.2206392896482272
    88 3130 1.2131239088425652 3.797077834677229
    89 1030 1.150618289417443 1.1851368380999663
    ];

sp4=[
    90 2940 1.3592488548329769 3.996191633208952
    90 2940 1.3592488548329769 3.996191633208952
    91 1040 1.1809912956002766 1.2282309474242876
    92 3071 1.24404700283771 3.8204683457146076
    93 1010 1.1266286074929595 1.137894893567889
    94 1775 1.1619721439693758 2.062500555545642
    95 3699 1.207553697714971 4.466741127847677
    96 1710 1.131270942324706 1.9344733113752475
    97 4625 1.1027443971645041 5.100192836885832
    98 1010 1.2140124201694482 1.2261525443711427
    99 3425 1.2090101900736916 4.140859901002393
    100 2095 1.1457784410882015 2.400405834079782
    101 1055 1.210227275002073 1.276789775127187
    102 3447 1.2800934678549216 4.412482183695914
    103 1060 1.148974333512523 1.2179127935232745
    104 2910 1.2936776894773858 3.7646020763791928
    105 1030 1.1955104048410083 1.2313757169862385
    106 1155 1.1290392890905518 1.3040403788995876
    107 3540 1.1746587271430438 4.158291894086375
    108 985 1.1401443649947605 1.123042199519839
    109 3270 1.2024502746473158 3.932012398096723
    110 1075 1.086619669015019 1.1681161441911454
    111 3455 1.16026134985689 4.008702963755555
    112 1035 1.1303783336370978 1.1699415753143962
    113 3410 1.2161921125359922 4.147215103747733
    114 1013 1.1709858042584214 1.1862086197137807
    115 3666 1.1958253566079333 4.383895757324684
    116 1125 1.1378546813295893 1.280086516495788
    117 3050 1.2063881702590329 3.6794839192900506
    118 930 1.2388824682310395 1.1521606954548667
    119 3490 1.1952038097650493 4.171261296080021
    ];
%%
%energy calculation
ml1 = sum(lp1(:,4));
ml2 = sum(lp2(:,4));
ml3 = sum(lp3(:,4));
ml4 = sum(lp4(:,4));
ml5 = sum(lp5(:,4));

mc1 = sum(cp1(:,4));
mc2 = sum(cp2(:,4));
mc3 = sum(cp3(:,4));
mc4 = sum(cp4(:,4));
mc5 = sum(cp5(:,4));

ms1 = sum(sp1(:,4));
ms2 = sum(sp2(:,4));
ms3 = sum(sp3(:,4));
ms4 = sum(sp4(:,4));
%ms5 = sum(sp5(:,4));

mean_ll = mean([ml1 ml2 ml3 ml4 ml5]);
std_ll = std([ml1 ml2 ml3 ml4 ml5]);

mean_c = mean([mc1 mc2 mc3 mc4 mc5]);
std_c = std([mc1 mc2 mc3 mc4 mc5]);

mean_s = mean([ms1 ms2 ms3 ms4 ]);
std_s = std([ms1 ms2 ms3 ms4]);

% Number of generated queries 
nl1 = length(lp1);
nl2 = length(lp2);
nl3 = length(lp3);
nl4 = length(lp4);
nl5 = length(lp5);

nc1 = length(cp1);
nc2 = length(cp2);
nc3 = length(cp3);
nc4 = length(cp4);
nc5 = length(cp5);

ns1 = length(sp1);
ns2 = length(sp2);
ns3 = length(sp3);
ns4 = length(sp4);
%ns5 = length(sp5);

mean_ll_n = mean([nl1 nl2 nl3 nl4 nl5]);
std_ll_n = std([nl1 nl2 nl3 nl4 nl5]);

mean_c_n = mean([nc1 nc2 nc3 nc4 nc5]);
std_c_n = std([nc1 nc2 nc3 nc4 nc5]);

mean_s_n = mean([ns1 ns2 ns3 ns4 ]);
std_s_n = std([ns1 ns2 ns3 ns4 ]);

%% plot
figure('Position',[440 378 560 620/3]);
bar([mean_ll mean_c mean_s]);
hold on
errorbar([mean_ll mean_c mean_s],[std_ll std_c std_s],'r.' , 'LineWidth' , 2);
ylabel('Joule');
hold off
labels = {'LP','CP' , 'SP'};
set(gca , 'xticklabel' , labels);
set(gca , 'fontsize' , 20);

figure('Position',[440 378 560 620/3]);
bar([mean_ll_n mean_c_n mean_s_n]);
hold on
errorbar([mean_ll_n mean_c_n mean_s_n],[std_ll_n std_c_n std_s_n],'r.' , 'LineWidth' , 2);
ylabel('Number of queries');
hold off

labels = {'LP','CP' , 'SP'};
set(gca , 'xticklabel' , labels);
set(gca , 'fontsize' , 20);